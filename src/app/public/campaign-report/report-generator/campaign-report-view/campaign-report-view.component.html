<div class="campaign-report-wrapper" *ngIf="!isCampaignPostsEnabled">
	<div class="scrollable-container">
		<div class="campaign-report-header">
			<div class="container">
				<button
					class="back-btn"
					data-cs-id="f59a8a6c-487d-4c0b-8dcf-c9f668db2b95"
					data-cs-label="Back"
					data-cs-source="page"
					(click)="navigateCampaignReport(); recordButtonClick($event)"
					*ngIf="isFromGroupAdmin"
				>
					<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
						<path
							d="M16.6663 9.16732H6.52467L11.183 4.50898L9.99967 3.33398L3.33301 10.0007L9.99967 16.6673L11.1747 15.4923L6.52467 10.834H16.6663V9.16732Z"
							fill="#3654FF"
						/>
					</svg>
					<span>Back</span>
				</button>

				<div class="reports-header">
					<div class="report-header-left">
						<h4 *ngIf="!isFromGroupAdmin">CAMPAIGN SUMMARY REPORT</h4>
						<h5 data-test-id="campaign-name">{{ campaignReportWithPosts?.CampaignDetails?.campaignName }}</h5>
						<h6 data-test-id="campaign-duration" *ngIf="campaignReportWithPosts">
							<strong>Campaign duration :</strong>
							{{ campaignReportWithPosts?.CampaignDetails?.startDate }}
							-
							{{ campaignReportWithPosts?.CampaignDetails?.endDate }}
						</h6>
					</div>
					<div class="report-header-right" *ngIf="isFromGroupAdmin">
						<button
							class="ghost-btn"
							data-cs-id="a63de628-db7f-4648-bc2b-99726751da17"
							data-cs-label="Edit"
							data-cs-source="page"
							(click)="navigateToCampaignReportEdit(); recordButtonClick($event)"
						>
							<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
								<path
									d="M2 11.6397V13.6664C2 13.853 2.14667 13.9997 2.33333 13.9997H4.36C4.44667 13.9997 4.53333 13.9664 4.59333 13.8997L11.8733 6.62638L9.37333 4.12638L2.1 11.3997C2.03333 11.4664 2 11.5464 2 11.6397ZM13.8067 4.69305C14.0667 4.43305 14.0667 4.01305 13.8067 3.75305L12.2467 2.19305C11.9867 1.93305 11.5667 1.93305 11.3067 2.19305L10.0867 3.41305L12.5867 5.91305L13.8067 4.69305Z"
									fill="#3654FF"
								/>
							</svg>
							<span>Edit</span>
						</button>
						<button
							class="ghost-btn"
							(click)="getShortenUrl(); recordButtonClick($event)"
							data-cs-id="e6f97ef4-8e89-4f43-a64b-2bd23249732d"
							data-cs-label="Share report"
							data-cs-source="page"
							*ngIf="campaign && campaign.isReportAvailable"
							data-target="#shareReport"
							data-toggle="modal"
						>
							<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
								<path
									d="M12 10.72C11.4933 10.72 11.04 10.92 10.6933 11.2333L5.94 8.46665C5.97333 8.31331 6 8.15998 6 7.99998C6 7.83998 5.97333 7.68665 5.94 7.53331L10.64 4.79331C11 5.12665 11.4733 5.33331 12 5.33331C13.1067 5.33331 14 4.43998 14 3.33331C14 2.22665 13.1067 1.33331 12 1.33331C10.8933 1.33331 10 2.22665 10 3.33331C10 3.49331 10.0267 3.64665 10.06 3.79998L5.36 6.53998C5 6.20665 4.52667 5.99998 4 5.99998C2.89333 5.99998 2 6.89331 2 7.99998C2 9.10665 2.89333 9.99998 4 9.99998C4.52667 9.99998 5 9.79331 5.36 9.45998L10.1067 12.2333C10.0733 12.3733 10.0533 12.52 10.0533 12.6666C10.0533 13.74 10.9267 14.6133 12 14.6133C13.0733 14.6133 13.9467 13.74 13.9467 12.6666C13.9467 11.5933 13.0733 10.72 12 10.72Z"
									fill="#3654FF"
								/>
							</svg>
							<span>Share report</span>
						</button>
					</div>
				</div>

				<div class="info-wrapper">
					<svg width="21" height="21" viewBox="0 0 21 21" fill="none" xmlns="http://www.w3.org/2000/svg">
						<path
							d="M10.1533 6.17448H11.82V7.84115H10.1533V6.17448ZM10.1533 9.50781H11.82V14.5078H10.1533V9.50781ZM10.9867 2.00781C6.38665 2.00781 2.65332 5.74115 2.65332 10.3411C2.65332 14.9411 6.38665 18.6745 10.9867 18.6745C15.5867 18.6745 19.32 14.9411 19.32 10.3411C19.32 5.74115 15.5867 2.00781 10.9867 2.00781ZM10.9867 17.0078C7.31165 17.0078 4.31999 14.0161 4.31999 10.3411C4.31999 6.66615 7.31165 3.67448 10.9867 3.67448C14.6617 3.67448 17.6533 6.66615 17.6533 10.3411C17.6533 14.0161 14.6617 17.0078 10.9867 17.0078Z"
							fill="#9999A7"
						/>
					</svg>
					<div data-test-id="subheading-generated-report">
						The data in this report may deviate from actual numbers as Facebook does not send some type of data over
						APIs.
						<a
							(click)="recordButtonClick($event)"
							data-cs-id="e028dc36-8f58-4e4b-ab48-9498c091f01c"
							data-cs-label="Learn more"
							data-cs-source="page"
							href="https://www.notion.so/Why-are-the-numbers-in-my-Convosight-insights-report-lower-d8f880622eb744d1b7c30c5fd2efebc8"
							target="_blank"
							rel="noopener"
							><span>Learn more</span>
							<svg width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg">
								<path
									d="M13.653 13.0085H4.31966V3.67513H8.98633V2.3418H4.31966C3.57966 2.3418 2.98633 2.9418 2.98633 3.67513V13.0085C2.98633 13.7418 3.57966 14.3418 4.31966 14.3418H13.653C14.3863 14.3418 14.9863 13.7418 14.9863 13.0085V8.3418H13.653V13.0085ZM10.3197 2.3418V3.67513H12.713L6.15966 10.2285L7.09966 11.1685L13.653 4.61513V7.00846H14.9863V2.3418H10.3197Z"
									fill="#3654FF"
								/>
							</svg>
						</a>
					</div>
				</div>
			</div>
		</div>

		<div
			class="report-note-wrapper"
			*ngIf="(campaign && campaign.isReportAvailable) || (campaignReportWithPosts && !isFromGroupAdmin)"
		>
			<div class="container">
				<div class="report-note-inner">
					<div class="report-note-left">
						<h6 *ngIf="autoUpdateDate">
							This report shall keep auto-updating till {{ autoUpdateDate | date: 'dd MMM, YYYY' }}
						</h6>
						<h6 *ngIf="!autoUpdateDate">
							<img alt="" src="../../../../../assets/images/completed-icon.svg" />
							<span>This report uses data for 7 more days after Campaign duration</span>
						</h6>
						<div *ngIf="autoUpdateDate">
							<svg width="12" height="13" viewBox="0 0 12 13" fill="none" xmlns="http://www.w3.org/2000/svg">
								<path
									d="M5.98665 0.508789C2.77832 0.508789 0.15332 3.13379 0.15332 6.34212C0.15332 9.55046 2.77832 12.1755 5.98665 12.1755C9.19499 12.1755 11.82 9.55046 11.82 6.34212C11.82 3.13379 9.19499 0.508789 5.98665 0.508789ZM8.43666 8.79212L5.40332 6.92546V3.42546H6.27832V6.45879L8.90332 8.03379L8.43666 8.79212Z"
									fill="white"
								/>
							</svg>
							<span>Last updated : {{ campaignReport?.lastUpdatedOnDate | date: 'dd MMM, YYYY, hh:mm a' }}</span>
						</div>
					</div>
					<div class="report-note-right">
						<button
							matTooltip="To capture the full effect of campaign posts on conversations in participating groups, the report shall keep getting auto-updated till 7 days after campaign duration"
							matTooltipPosition="below"
							click="tooltip.toggle()"
							#tooltip="matTooltip"
							data-cs-parent-label="Tooltip"
							data-cs-label="To capture the full effect of campaign posts on conversations in participating groups, the report shall keep getting auto-updated till 7 days after campaign duration"
							data-cs-source="page"
							(mouseenter)="tooltipHovered($event)"
						>
							<svg width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg">
								<path
									d="M8.31934 5.00814H9.65267V6.34147H8.31934V5.00814ZM8.31934 7.6748H9.65267V11.6748H8.31934V7.6748ZM8.986 1.6748C5.306 1.6748 2.31934 4.66147 2.31934 8.34147C2.31934 12.0215 5.306 15.0081 8.986 15.0081C12.666 15.0081 15.6527 12.0215 15.6527 8.34147C15.6527 4.66147 12.666 1.6748 8.986 1.6748ZM8.986 13.6748C6.046 13.6748 3.65267 11.2815 3.65267 8.34147C3.65267 5.40147 6.046 3.00814 8.986 3.00814C11.926 3.00814 14.3193 5.40147 14.3193 8.34147C14.3193 11.2815 11.926 13.6748 8.986 13.6748Z"
									fill="white"
								/>
							</svg>
							<span>Learn more</span>
						</button>
					</div>
				</div>
			</div>
		</div>
		<div
			class="container"
			*ngIf="
				(campaign && campaign.isReportAvailable && campaignReportWithPosts) ||
				(campaignReportWithPosts && !isFromGroupAdmin)
			"
		>
			<div
				class="report-box"
				*ngIf="(campaignReportWithPosts?.CampaignDetails?.campaignSummary && !isFromGroupAdmin) || isFromGroupAdmin"
			>
				<div class="campaign-summary-box">
					<div class="summary-box-left">
						<h3>
							<span>Campaign summary</span>
							<app-tooltip
								setTooltipText="Communicate key highlights of the campaign to brands with a well-written campaign summary"
							>
							</app-tooltip>
						</h3>
						<h6 *ngIf="!campaign?.campaignSummary && isFromGroupAdmin">
							Write a campaign summary to communicate key highlights of the campaign to brands
						</h6>
					</div>
					<div class="summary-box-right" *ngIf="isFromGroupAdmin">
						<button
							class="ghost-btn"
							data-target="#addCampaignSummary"
							data-toggle="modal"
							data-cs-id="2ee439a4-d519-42c2-b540-eeca99b3df53"
							data-cs-label="Add a campaign summary"
							data-cs-source="page"
							(click)="recordButtonClick($event)"
							*ngIf="!campaign?.campaignSummary"
						>
							<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
								<path
									d="M11.3333 12.813H3.33333V4.66634H8V3.33301H3.33333C2.6 3.33301 2 3.93301 2 4.66634V12.6663C2 13.3997 2.6 13.9997 3.33333 13.9997H11.3333C12.0667 13.9997 12.6667 13.3997 12.6667 12.6663V7.99967H11.3333V12.813Z"
									fill="#3654FF"
								/>
								<path
									d="M12.6663 1.33301H11.333V3.33301H9.33301C9.33967 3.33967 9.33301 4.66634 9.33301 4.66634H11.333V6.65967C11.3397 6.66634 12.6663 6.65967 12.6663 6.65967V4.66634H14.6663V3.33301H12.6663V1.33301Z"
									fill="#3654FF"
								/>
								<path d="M10.0003 6H4.66699V7.33333H10.0003V6Z" fill="#3654FF" />
								<path d="M4.66699 8V9.33333H10.0003V8H8.00033H4.66699Z" fill="#3654FF" />
								<path d="M10.0003 10H4.66699V11.3333H10.0003V10Z" fill="#3654FF" />
							</svg>
							<span>Add a campaign summary</span>
						</button>
						<button
							class="ghost-btn"
							(click)="campaignSummary = campaign?.campaignSummary; recordButtonClick($event)"
							data-target="#addCampaignSummary"
							data-cs-id="597c1e10-cf94-42a8-a4f4-8fc98a4be031"
							data-cs-label="Edit"
							data-cs-source="page"
							data-toggle="modal"
							*ngIf="campaign?.campaignSummary"
						>
							<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
								<path
									d="M2 11.6397V13.6664C2 13.853 2.14667 13.9997 2.33333 13.9997H4.36C4.44667 13.9997 4.53333 13.9664 4.59333 13.8997L11.8733 6.62638L9.37333 4.12638L2.1 11.3997C2.03333 11.4664 2 11.5464 2 11.6397ZM13.8067 4.69305C14.0667 4.43305 14.0667 4.01305 13.8067 3.75305L12.2467 2.19305C11.9867 1.93305 11.5667 1.93305 11.3067 2.19305L10.0867 3.41305L12.5867 5.91305L13.8067 4.69305Z"
									fill="#3654FF"
								/>
							</svg>
							<span>Edit</span>
						</button>
					</div>
				</div>

				<div class="campaign-summary-box">
					<div
						class="campaign-summary"
						*ngIf="campaign?.campaignSummary && isFromGroupAdmin"
						[innerHtml]="campaign.campaignSummary | sanitizeHtml"
					></div>
					<div
						class="campaign-summary"
						*ngIf="campaignReportWithPosts?.CampaignDetails?.campaignSummary && !isFromGroupAdmin"
						[innerHtml]="campaignReportWithPosts?.CampaignDetails?.campaignSummary | sanitizeHtml"
					></div>
				</div>
			</div>

			<div class="report-box">
				<div class="campaign-summary-box">
					<div class="row keywords-wrap">
						<div class="col keyword-col" id="facebook-groups">
							<h3>Facebook groups ({{ participantGroupsDetails?.length }})</h3>
							<div class="keywords-list">
								<span class="badge" *ngFor="let group of participantGroupsDetails | slice: 0:3">{{ group.name }}</span>
							</div>
							<button
								class="view-link keyword-show"
								*ngIf="participantGroupsDetails?.length > 3"
								data-target="#allKeywordsList"
								data-toggle="modal"
							>
								+ View more
							</button>
						</div>
						<div
							class="col keyword-col"
							id="brand-keywords"
							*ngIf="campaignReportWithPosts?.CampaignDetails?.brandKeywords?.length > 0"
						>
							<h3>Brand keywords ({{ campaignReportWithPosts?.CampaignDetails?.brandKeywords?.length }})</h3>
							<div class="keywords-list">
								<span
									class="badge"
									*ngFor="let keyword of campaignReportWithPosts?.CampaignDetails?.brandKeywords | slice: 0:3"
									>{{ keyword }}</span
								>
							</div>
							<button
								class="view-link keyword-show"
								*ngIf="campaignReportWithPosts?.CampaignDetails?.brandKeywords?.length > 3"
								data-target="#allKeywordsList"
								data-toggle="modal"
							>
								+ View more
							</button>
						</div>
						<div
							class="col keyword-col"
							id="keywords-hashtags"
							*ngIf="campaignReportWithPosts?.CampaignDetails?.customKeywords?.length > 0"
						>
							<h3>Keywords & hashtags ({{ campaignReportWithPosts?.CampaignDetails?.customKeywords?.length }})</h3>
							<div class="keywords-list">
								<span
									class="badge"
									*ngFor="let hashtag of campaignReportWithPosts?.CampaignDetails?.customKeywords | slice: 0:3"
									>{{ hashtag }}</span
								>
							</div>
							<button
								class="view-link keyword-show"
								*ngIf="campaignReportWithPosts?.CampaignDetails?.customKeywords?.length > 3"
								data-target="#allKeywordsList"
								data-toggle="modal"
							>
								+ View more
							</button>
						</div>
					</div>
				</div>
			</div>

			<div class="report-box">
				<div class="key-matrix-box">
					<h3>
						<span>Key Metrics</span>
						<app-tooltip setTooltipText="Key performance indicators for the campaign"></app-tooltip>
					</h3>

					<div class="matrix-box-ul">
						<div class="matrix-box-li">
							<figure>
								<img alt="" src="../../../../../assets/images/reports/icon_1.svg" />
							</figure>
							<figcaption>
								<p>
									Groups
									<app-tooltip
										class="ml-1"
										setTooltipText="Total number of Facebook groups that participated in the campaign"
									>
									</app-tooltip>
								</p>
								<h6>{{ campaignReport?.numGroups ? campaignReport?.numGroups : '-' }}</h6>
							</figcaption>
						</div>
						<div class="matrix-box-li">
							<figure>
								<img alt="" src="../../../../../assets/images/reports/icon_2.svg" />
							</figure>
							<figcaption>
								<p>
									Admin posts
									<app-tooltip
										class="ml-1"
										setTooltipText="Number of posts done by admin and moderators of the group."
										*ngIf="!isFromGroupAdmin"
									>
									</app-tooltip>
									<app-tooltip
										class="ml-1"
										setTooltipText="Number of posts done by any of your team members added on the “Add moderators” screen for the respective group"
										*ngIf="isFromGroupAdmin"
									>
									</app-tooltip>
								</p>
								<h6>{{ campaignReport?.numAdminPosts ? campaignReport?.numAdminPosts : '-' }}</h6>
							</figcaption>
						</div>
						<div class="matrix-box-li">
							<figure>
								<img alt="" src="../../../../../assets/images/reports/icon_3.svg" />
							</figure>
							<figcaption>
								<p>
									Group member posts
									<app-tooltip
										class="ml-1"
										setTooltipText="Number of posts by group members using campaign keywords during the campaign duration and next 7 days"
									>
									</app-tooltip>
								</p>
								<h6>{{ campaignReport?.numOrganicPosts ? campaignReport?.numOrganicPosts : '-' }}</h6>
							</figcaption>
						</div>
					</div>

					<div class="matrix-box-ul">
						<div class="matrix-box-li">
							<figure>
								<img alt="" src="../../../../../assets/images/reports/icon_6.svg" />
							</figure>
							<figcaption>
								<p>
									Total reactions
									<app-tooltip
										class="ml-1"
										setTooltipText="Total number of reactions on posts and comments across campaign and organic posts during campaign duration and next 7 days"
									>
									</app-tooltip>
								</p>
								<h6>{{ campaignReport?.totalReactions ? campaignReport?.totalReactions : '-' }}</h6>
							</figcaption>
						</div>
						<div class="matrix-box-li">
							<figure>
								<img alt="" src="../../../../../assets/images/reports/icon_7.svg" />
							</figure>
							<figcaption>
								<p>
									Total comments
									<app-tooltip
										class="ml-1"
										setTooltipText="Total number of comments across campaign and organic posts during campaign duration and next 7 days"
									>
									</app-tooltip>
								</p>
								<h6>{{ campaignReport?.totalComments ? campaignReport?.totalComments : '-' }}</h6>
							</figcaption>
						</div>
					</div>
				</div>
			</div>

			<div class="report-box" *ngIf="campaignReport?.campaignHighlights?.length > 0">
				<div class="screenshot-box">
					<div class="screenshot-box-header">
						<div class="box-header-left">
							<h3>
								<span data-test-id="heading-campaign-highlight">Campaign highlights</span>
								<app-tooltip
									setTooltipText="Screenshots of top posts for this campaign during campaign duration and next 7 days"
								>
								</app-tooltip>
							</h3>
							<h6 data-test-id="subheading-campaignhighlights" *ngIf="campaignReport?.lastScreenshotTime">
								Screenshots generated on
								{{ campaignReport?.lastScreenshotTime | date: 'dd MMM YYYY, hh:mm a' }}
							</h6>
						</div>
						<div class="box-header-right" *ngIf="isFromGroupAdmin">
							<button
								class="ghost-btn"
								data-cs-id="dcf8fc77-cfae-44f5-8938-cd14578d70d7"
								data-cs-label="Edit highlights"
								data-cs-source="page"
								(click)="isCampaignPostsEnabled = true; recordButtonClick($event)"
							>
								<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
									<path
										d="M12.6667 4.66634V6.65967C12.6667 6.65967 11.34 6.66634 11.3333 6.65967V4.66634H9.33333C9.33333 4.66634 9.34 3.33967 9.33333 3.33301H11.3333V1.33301H12.6667V3.33301H14.6667V4.66634H12.6667ZM10.6667 7.33301V5.33301H8.66667V3.33301H3.33333C2.6 3.33301 2 3.93301 2 4.66634V12.6663C2 13.3997 2.6 13.9997 3.33333 13.9997H11.3333C12.0667 13.9997 12.6667 13.3997 12.6667 12.6663V7.33301H10.6667ZM3.33333 12.6663L5.33333 9.99967L6.66667 11.9997L8.66667 9.33301L11.3333 12.6663H3.33333Z"
										fill="#3654FF"
									/>
								</svg>
								<span>Edit highlights</span>
							</button>
						</div>
					</div>
					<div class="screenshot-box-body">
						<ul class="list-unstyled">
							<li data-test-id="list-screenshot-post" *ngFor="let url of campaignHighlights; let i = index">
								<figure data-test-id="list-screenshot-post-figure">
									<img
										[src]="url?.src"
										alt=""
										data-cs-id="b008f284-7a40-4561-9f77-efae5f07be51"
										data-cs-label="Open Image Viewer"
										data-cs-source="page"
										(click)="openImageGallery(i, campaignHighlights); recordButtonClick($event)"
									/>
								</figure>
							</li>
						</ul>
					</div>
				</div>
			</div>

			<div class="report-box" *ngIf="beforeAndAfterKeywordMentions?.length > 0">
				<div class="keyword-box">
					<div class="keyword-box-header">
						<div class="box-header-left">
							<h3>
								<span>Keyword & hashtag mention count</span>
								<app-tooltip
									setTooltipText="Compare number of mentions of campaign keywords and hashtags in participating groups, before and after the campaign"
								>
								</app-tooltip>
							</h3>
						</div>
						<div class="box-header-right">
							<ul class="list-unstyled">
								<li>
									<div class="color-box color-1"></div>
									<span>Before campaign</span>
									<app-tooltip
										class="ml-1 tooltip-small"
										setTooltipText="Total count during the (Campaign duration + 7) days period before the Campaign first post date"
									>
									</app-tooltip>
								</li>
								<li>
									<div class="color-box color-2"></div>
									<span>After campaign</span>
									<app-tooltip
										class="ml-1 tooltip-small"
										setTooltipText="Total count during time period from Campaign first post date to (Campaign first post date + (Campaign duration + 7))"
									>
									</app-tooltip>
								</li>
							</ul>
						</div>
					</div>
					<div class="keyword-box-table table-wrapper">
						<table aria-labelledby="">
							<thead>
								<tr>
									<th>
										<div>Keyword / HASHTAG</div>
									</th>
									<th>
										<div>VOLUME</div>
									</th>
									<th>
										<div>
											<span>IMPACT</span>
											<app-tooltip
												class="ml-1 tooltip-small"
												setTooltipText="Change in count over campaign reporting duration"
											>
											</app-tooltip>
										</div>
									</th>
								</tr>
							</thead>
							<tbody>
								<tr *ngFor="let keyword of beforeAndAfterKeywordMentions">
									<td>
										<div>{{ keyword.name }}</div>
									</td>
									<td>
										<div class="row-graph">
											<ul class="list-unstyled">
												<li>
													<div class="row-bar light-row" [ngStyle]="{width: keyword.beforePercentage + 1 + '%'}"></div>
													<span>{{ keyword.beforeValue }}</span>
												</li>
												<li>
													<div class="row-bar dark-row" [ngStyle]="{width: keyword.afterPercentage + 1 + '%'}"></div>
													<strong>{{ keyword.afterValue }}</strong>
												</li>
											</ul>
										</div>
									</td>
									<td>
										<div class="impact-wrap" [ngClass]="{down: keyword.impact < 0, up: keyword.impact > 0}">
											<span>{{ keyword.impact }}</span>
											<div class="impact-change" *ngIf="keyword.beforeValue > 0">
												(<img *ngIf="keyword.impact >= 0" alt="" src="../../../../../assets/images/reports/up.svg" />
												<img
													*ngIf="keyword.impact < 0"
													alt=""
													src="../../../../../assets/images/reports/arrow_downward.svg"
												/>
												<span>{{ keyword.impactPercentage }}%</span>)
											</div>
											<div
												class="impact-change"
												[ngClass]="{'not-allowed': keyword.beforeValue === 0}"
												*ngIf="keyword.beforeValue === 0"
											>
												( - NA)
											</div>
										</div>
									</td>
								</tr>
							</tbody>
						</table>
					</div>
				</div>
			</div>

			<div
				class="report-box"
				*ngIf="beforeAndAfterBrandConversations?.length > 0 && !isBrandMentionsAndConversationsEmpty"
			>
				<div class="keyword-box">
					<div class="keyword-box-header">
						<div class="box-header-left">
							<h3>
								<span>Brand mentions and conversations count</span>
								<app-tooltip
									setTooltipText="Compare number of brand conversations and mentions in participating groups, before and after the campaign"
								>
								</app-tooltip>
							</h3>
						</div>
						<div class="box-header-right">
							<ul class="list-unstyled">
								<li>
									<div class="color-box color-1"></div>
									<span>Before campaign</span>
									<app-tooltip
										class="ml-1 tooltip-small"
										setTooltipText="Total count during the (Campaign duration + 7) days period before the Campaign first post date"
									>
									</app-tooltip>
								</li>
								<li>
									<div class="color-box color-2"></div>
									<span>After campaign</span>
									<app-tooltip
										class="ml-1 tooltip-small"
										setTooltipText="Total count during time period from Campaign first post date to (Campaign first post date + (Campaign duration + 7))"
									>
									</app-tooltip>
								</li>
							</ul>
						</div>
					</div>
					<div class="brand-box-table table-wrapper">
						<table aria-labelledby="">
							<thead>
								<tr>
									<th>
										<div>METRIC</div>
									</th>
									<th>
										<div>COUNT</div>
									</th>
									<th>
										<div>
											<span>IMPACT</span>
											<app-tooltip
												class="ml-1 tooltip-small"
												setTooltipText="Change in count over campaign reporting duration"
											>
											</app-tooltip>
										</div>
									</th>
								</tr>
							</thead>
							<tbody>
								<tr *ngFor="let conversation of beforeAndAfterBrandConversations">
									<td>
										<div>{{ conversation.name }}</div>
										<span class="coversation-msg" *ngIf="conversation.name === 'Brand Mentions'"
											>The total number of times brand is mentioned across posts and comments during the campaign</span
										>
										<span class="coversation-msg" *ngIf="conversation.name === 'Brand Conversations'"
											>The total number of posts and comments containing brand name during the campaign</span
										>
									</td>
									<td>
										<div class="row-graph">
											<ul class="list-unstyled">
												<li>
													<div
														class="row-bar light-row"
														[ngStyle]="{width: conversation.beforePercentage + 1 + '%'}"
													></div>
													<span>{{ conversation.beforeValue }}</span>
												</li>
												<li>
													<div
														class="row-bar dark-row"
														[ngStyle]="{width: conversation.afterPercentage + 1 + '%'}"
													></div>
													<strong>{{ conversation.afterValue }}</strong>
												</li>
											</ul>
										</div>
									</td>
									<td>
										<div class="impact-wrap up" [ngClass]="{down: conversation.impact < 0}">
											<span>{{ conversation.impact }}</span>
											<div class="impact-change" *ngIf="conversation.beforeValue > 0">
												(<img
													*ngIf="conversation.impact >= 0"
													alt=""
													src="../../../../../assets/images/reports/up.svg"
												/>
												<img
													*ngIf="conversation.impact < 0"
													alt=""
													src="../../../../../assets/images/reports/arrow_downward.svg"
												/>
												<span>{{ conversation.impactPercentage }}%</span>)
											</div>
											<div
												class="impact-change"
												[ngClass]="{'not-allowed': conversation.beforeValue === 0}"
												*ngIf="conversation.beforeValue === 0"
											>
												( - NA)
											</div>
										</div>
									</td>
								</tr>
							</tbody>
						</table>
					</div>
				</div>
			</div>

			<div class="report-box" *ngIf="beforeAndAfterKeywordMentionsByGroup?.length > 1">
				<div class="keyword-box">
					<div class="keyword-box-header">
						<div class="box-header-left">
							<h3>
								<span>Keyword, hashtag & brand mention count by group</span>
								<app-tooltip
									setTooltipText="Total number of times campaign keywords, hashtags and brand mentions appeared in each group for the campaign duration and next 7 days"
								>
								</app-tooltip>
							</h3>
						</div>
						<div class="box-header-right">
							<ul class="list-unstyled">
								<li>
									<div class="color-box color-1"></div>
									<span>Before campaign</span>
									<app-tooltip
										class="ml-1 tooltip-small"
										setTooltipText="Total count during the (Campaign duration + 7) days period before the Campaign first post date"
									>
									</app-tooltip>
								</li>
								<li>
									<div class="color-box color-2"></div>
									<span>After campaign</span>
									<app-tooltip
										class="ml-1 tooltip-small"
										setTooltipText="Total count during time period from Campaign first post date to (Campaign first post date + (Campaign duration + 7))"
									>
									</app-tooltip>
								</li>
							</ul>
						</div>
					</div>
					<div class="engagement-box-table table-wrapper">
						<table aria-labelledby="">
							<thead>
								<tr>
									<th>
										<div>GROUP NAME</div>
									</th>
									<th>
										<div>VOLUME</div>
									</th>
								</tr>
							</thead>
							<tbody>
								<tr *ngFor="let group of beforeAndAfterKeywordMentionsByGroup">
									<td>
										<div>{{ group.name }}</div>
									</td>
									<td>
										<div class="row-graph">
											<ul class="list-unstyled">
												<li>
													<div class="row-bar light-row" [ngStyle]="{width: group.beforePercentage + 1 + '%'}"></div>
													<span>{{ group.beforeValue }}</span>
												</li>
												<li>
													<div class="row-bar dark-row" [ngStyle]="{width: group.afterPercentage + 1 + '%'}"></div>
													<strong>{{ group.afterValue }}</strong>
												</li>
											</ul>
										</div>
									</td>
								</tr>
							</tbody>
						</table>
					</div>
				</div>
			</div>

			<div class="report-box" *ngIf="campaignPosts?.length > 0">
				<div class="all-post-box">
					<h3>
						All Posts <span class="text-secondary ml-1">({{ campaignPosts.length }})</span>
					</h3>
					<div class="table-wrapper">
						<table aria-labelledby="">
							<thead>
								<tr>
									<th class="text-left">
										<div>TIME</div>
									</th>
									<th class="text-left">
										<div>POST</div>
									</th>
									<th>
										<div class="justify-content-center">POSTED IN GROUP</div>
									</th>
									<th>
										<div class="justify-content-center">Reactions</div>
									</th>
									<th>
										<div class="justify-content-center">Comments</div>
									</th>
								</tr>
							</thead>
							<tbody *ngFor="let post of campaignPosts | slice: from:end">
								<tr
									data-cs-label="View post"
									data-cs-source="page"
									data-cs-id="cf1a437c-4d97-4119-9d05-d44058a2d245"
									(click)="toggleMoreInfo($event); recordButtonClick($event)"
								>
									<td>
										<div class="date-wrap">
											{{ post?.postCreatedAtUTC | date: 'dd MMM, YYYY' }} <br />{{
												post?.postCreatedAtUTC | date: 'hh:mm a'
											}}
										</div>
									</td>
									<td class="post-desc-wrap">
										<div class="post-desc">
											<figure>
												<img
													*ngIf="!post.postPhotoUrl"
													alt=""
													src="../../../../../assets/images/default_group_image.jpg"
												/>
												<img [src]="post.postPhotoUrl" *ngIf="post.postPhotoUrl" />
											</figure>
											<div class="post-content">
												<h5>
													{{ post?.postRawText?.substring(0, 100) + (post?.postRawText?.length >= 100 ? '...' : '') }}
												</h5>
												<ul class="list-unstyled">
													<li><a>View post</a></li>
													<li *ngIf="post.isAdminPost">
														<img alt="" src="../../../../../assets/images/reports/star.svg" /><span>Admin post</span>
													</li>
													<li *ngIf="post.postCreatedByName">
														<span>by {{ post.postCreatedByName }}</span>
													</li>
												</ul>
											</div>
										</div>
									</td>
									<td class="group-name">
										<div>{{ post?.groupName }}</div>
									</td>
									<td>
										<div>{{ post?.reactionCount }}</div>
									</td>
									<td>
										<div>{{ post?.commentCount }}</div>
									</td>
								</tr>
								<tr [ngClass]="moreInfoRow ? 'show' : ''" id="{{ post.id }}" class="info-row">
									<td></td>
									<td colspan="5">
										<div class="more-info">
											<div>
												<button
													type="button"
													class="close"
													data-cs-label="Close"
													data-cs-source="page"
													data-cs-id="48ea5739-bcea-45c8-83e9-8a86f61d86de"
													(click)="toggleInfo(post.id); recordButtonClick($event)"
													aria-label="Close"
												>
													<svg
														width="20"
														height="21"
														viewBox="0 0 20 21"
														fill="none"
														xmlns="http://www.w3.org/2000/svg"
													>
														<path
															d="M15.8327 5.68379L14.6577 4.50879L9.99935 9.16712L5.34102 4.50879L4.16602 5.68379L8.82435 10.3421L4.16602 15.0005L5.34102 16.1755L9.99935 11.5171L14.6577 16.1755L15.8327 15.0005L11.1743 10.3421L15.8327 5.68379Z"
															fill="#707084"
														/>
													</svg>
												</button>
											</div>
											<div>
												{{ post.postRawText }}
												<div><img [src]="post.postPhotoUrl" *ngIf="post.postPhotoUrl" /></div>
												<div class="view-post-link">
													<a href="{{ post['fbPermlink'] }}" rel="noopener" target="_blank">
														View post on Facebook
														<svg
															width="12"
															height="12"
															viewBox="0 0 12 12"
															fill="none"
															xmlns="http://www.w3.org/2000/svg"
														>
															<path
																d="M10.6667 10.6667H1.33333V1.33333H6V0H1.33333C0.593333 0 0 0.6 0 1.33333V10.6667C0 11.4 0.593333 12 1.33333 12H10.6667C11.4 12 12 11.4 12 10.6667V6H10.6667V10.6667ZM7.33333 0V1.33333H9.72667L3.17333 7.88667L4.11333 8.82667L10.6667 2.27333V4.66667H12V0H7.33333Z"
																fill="#3654FF"
															/>
														</svg>
													</a>
												</div>
											</div>
										</div>
									</td>
								</tr>
							</tbody>
						</table>
					</div>
					<div class="pagination-wrap" *ngIf="!isLoading && campaignPosts?.length > 0">
						<span>{{ from + 1 + '-' + (campaignPosts?.length < end ? campaignPosts?.length : end) }} of All posts</span>
						<button
							[disabled]="from <= 0"
							data-cs-label="Get Previous Conversation"
							data-cs-source="page"
							(click)="getPreviousConversations()"
						>
							<svg focusable="false" viewBox="0 0 24 24">
								<path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"></path>
							</svg>
						</button>
						<button
							[disabled]="end > campaignPosts.length || (end >= campaignPosts.length && isConversationsLoaded)"
							data-cs-label="Get Next Conversation"
							data-cs-source="page"
							(click)="getNextConversations()"
						>
							<svg focusable="false" viewBox="0 0 24 24">
								<path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path>
							</svg>
						</button>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

<div class="container" *ngIf="!campaignReportWithPosts">
	<div class="loading-wrapper">
		<div class="bt-spinner-center"></div>
	</div>
</div>

<div class="generate-report-modal" *ngIf="campaign && !campaign.isReportAvailable">
	<div class="generate-modal-content">
		<figure>
			<img alt="" data-test-id="img-generating-report" src="../../../../../assets/images/Generate-report-icon.svg" />
		</figure>
		<h6 data-test-id="heading-generating-report">Generating your campaign report...</h6>
		<p data-test-id="subheading-generating-report">
			It usually takes us between 15-30 minutes to build your report. We’ll send you a link to it over Whatsapp and
			email once it is ready!
		</p>
		<div>
			<a
				*ngIf="!user.whatsappSubscriptionStatus"
				data-cs-id="ddc29865-5793-4238-a42d-e0817d709dfc"
				data-cs-label="Not subscribed to Whatsapp? Subscribe now"
				data-cs-source="page"
				(click)="openSubscribeNowOverlay(); recordButtonClick($event)"
				>Not subscribed to Whatsapp? Subscribe now</a
			>
		</div>
	</div>
</div>

<!-- Whatsapp Optin Popup starts here -->
<div
	class="convosight-whatsapp-opt-in modal fade"
	data-backdrop="static"
	id="convosight-whatsapp-opt"
	[class.show-did-not-modal]="showDidNotRecievedPopup"
	*ngIf="isFromGroupAdmin"
>
	<div class="modal-dialog modal-dialog-centered">
		<div class="modal-content">
			<app-whatsapp-opt-in
				[showConfirmation]="showConfirmation"
				[closeConfirmation]="'true'"
				(hideWAConfirmOptInCard)="hideWAConfirmOptInCard()"
				(hideWhatsAppOverlay)="hideWhatsAppOverlay()"
				(didNotReceiveCardStatus)="didNotReceiveCardStatus($event)"
			></app-whatsapp-opt-in>
		</div>
	</div>
</div>
<!-- Whatsapp Optin Popup ends here -->
<!-- Modal -->
<div
	class="modal fade campaign-summary-modal"
	id="addCampaignSummary"
	tabindex="-1"
	aria-labelledby="addCampaignSummary"
	aria-hidden="true"
>
	<div class="modal-dialog modal-dialog-centered">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title">Add a campaign summary</h5>
				<button
					type="button"
					data-cs-id="976b74db-110b-48aa-a23f-53ad33bd8b95"
					data-cs-label="Close"
					data-cs-source="page"
					(click)="recordButtonClick($event)"
					class="close"
					data-dismiss="modal"
					aria-label="Close"
				>
					<span aria-hidden="true">&times;</span>
				</button>
			</div>
			<div class="modal-body">
				<quill-editor
					[modules]="quillConfig"
					placeholder="Mention key highlights about performance of the campaign"
					[(ngModel)]="campaignSummary"
				>
				</quill-editor>
			</div>
			<div class="modal-footer border-0 pt-0">
				<button
					type="button"
					class="btn-block convo-btn-normal convo-btn-primary"
					data-cs-id="ce5585b4-64a3-4056-8d6e-108f63cc5c39"
					data-cs-label="Done"
					data-cs-source="page"
					(click)="updateCampaign(); recordButtonClick($event)"
					[disabled]="isSubmitting"
				>
					{{ isSubmitting ? 'Submitting...' : 'Done' }}
				</button>
				<span id="cancel" data-dismiss="modal" hidden></span>
			</div>
		</div>
	</div>
</div>

<div
	class="modal fade share-report-modal"
	id="shareReport"
	tabindex="-1"
	aria-labelledby="shareReport"
	aria-hidden="true"
>
	<div class="modal-dialog modal-dialog-centered">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title">Share Report</h5>
				<button
					type="button"
					data-cs-id="56991f1a-659e-4a45-be28-8f869e1f39d1"
					data-cs-label="Close"
					data-cs-source="dialog"
					(click)="recordButtonClick($event)"
					class="close"
					data-dismiss="modal"
					aria-label="Close"
				>
					<span aria-hidden="true">&times;</span>
				</button>
			</div>
			<div class="modal-body">
				<h6>Link to share</h6>
				<div class="input-wrap">
					<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<path
							d="M3.9 12C3.9 10.29 5.29 8.9 7 8.9H11V7H7C4.24 7 2 9.24 2 12C2 14.76 4.24 17 7 17H11V15.1H7C5.29 15.1 3.9 13.71 3.9 12ZM8 13H16V11H8V13ZM17 7H13V8.9H17C18.71 8.9 20.1 10.29 20.1 12C20.1 13.71 18.71 15.1 17 15.1H13V17H17C19.76 17 22 14.76 22 12C22 9.24 19.76 7 17 7Z"
							fill="#9999A7"
						/>
					</svg>
					<input [value]="shortenUrl" id="copyCode" readonly />
				</div>

				<div class="view-note">
					<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
						<path
							d="M7.99935 3C4.66602 3 1.81935 5.07333 0.666016 8C1.81935 10.9267 4.66602 13 7.99935 13C11.3327 13 14.1793 10.9267 15.3327 8C14.1793 5.07333 11.3327 3 7.99935 3ZM7.99935 11.3333C6.15935 11.3333 4.66602 9.84 4.66602 8C4.66602 6.16 6.15935 4.66667 7.99935 4.66667C9.83935 4.66667 11.3327 6.16 11.3327 8C11.3327 9.84 9.83935 11.3333 7.99935 11.3333ZM7.99935 6C6.89268 6 5.99935 6.89333 5.99935 8C5.99935 9.10667 6.89268 10 7.99935 10C9.10602 10 9.99935 9.10667 9.99935 8C9.99935 6.89333 9.10602 6 7.99935 6Z"
							fill="#9999A7"
						/>
					</svg>
					<span>Anyone with this link can view the report</span>
				</div>
			</div>

			<div class="modal-footer border-0 pt-0">
				<button
					type="button"
					class="btn-block convo-btn-normal convo-btn-primary"
					data-cs-id="f49c261c-7503-4c7b-b1d6-cf97241ae0e3"
					data-cs-label="Copy link"
					data-cs-source="dialog"
					(click)="copyToClipboard(); recordButtonClick($event)"
				>
					<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
						<path
							d="M10.6673 0.666656H2.66732C1.93398 0.666656 1.33398 1.26666 1.33398 1.99999V11.3333H2.66732V1.99999H10.6673V0.666656ZM12.6673 3.33332H5.33398C4.60065 3.33332 4.00065 3.93332 4.00065 4.66666V14C4.00065 14.7333 4.60065 15.3333 5.33398 15.3333H12.6673C13.4007 15.3333 14.0007 14.7333 14.0007 14V4.66666C14.0007 3.93332 13.4007 3.33332 12.6673 3.33332ZM12.6673 14H5.33398V4.66666H12.6673V14Z"
							fill="white"
						/>
					</svg>

					<span>Copy link</span>
				</button>
				<span id="cancelShareLink" data-dismiss="modal" hidden></span>
			</div>
		</div>
	</div>
</div>

<div *ngIf="isCampaignPostsEnabled">
	<app-campaign-report-posts
		[campaign]="campaign"
		[startDate]="campaign?.startDateAtUTC"
		[endDate]="campaign?.endDateAtUTC"
		[groups]="groupIds"
		[campaignHighlights]="campaignReport?.campaignHighlights"
		[isFromReportView]="isCampaignPostsEnabled"
		(closeConversations)="closeConversations($event)"
	>
	</app-campaign-report-posts>
</div>

<div class="modal fade all-keywords-list-modal" id="allKeywordsList" role="dialog" tabindex="-1">
	<div class="modal-dialog modal-dialog-centered modal-dialog-scrollable" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title">Campaign info</h5>
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
			</div>
			<div class="modal-body">
				<div class="modal-keywords-row" *ngIf="participantGroupsDetails?.length > 0">
					<h5>Facebook groups ({{ participantGroupsDetails?.length }})</h5>
					<div class="keywords-list">
						<span class="badge" *ngFor="let group of participantGroupsDetails">{{ group.name }}</span>
					</div>
				</div>

				<div class="modal-keywords-row" *ngIf="campaignReportWithPosts?.CampaignDetails?.brandKeywords?.length > 0">
					<h5>Brand keywords ({{ campaignReportWithPosts?.CampaignDetails?.brandKeywords?.length }})</h5>
					<div class="keywords-list">
						<span class="badge" *ngFor="let keyword of campaignReportWithPosts?.CampaignDetails?.brandKeywords">{{
							keyword
						}}</span>
					</div>
				</div>

				<div class="modal-keywords-row" *ngIf="campaignReportWithPosts?.CampaignDetails?.customKeywords?.length > 0">
					<h5>Keywords & hashtags ({{ campaignReportWithPosts?.CampaignDetails?.customKeywords?.length }})</h5>
					<div class="keywords-list">
						<span class="badge" *ngFor="let hashtag of campaignReportWithPosts?.CampaignDetails?.customKeywords">{{
							hashtag
						}}</span>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
