<mat-accordion *ngIf="isEditable; else publicPage">
	<div
		class="brands-wrap red-border"
		[class.expanded-state]="isExpanded"
		[class.not-completed]="noOfTalkedBrands() === 0"
	>
		<div class="completed-flag" *ngIf="showNoFilledBorder && noOfTalkedBrands() === 0">
			<svg width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg">
				<path
					d="M7.9987 5.44076C8.36537 5.44076 8.66536 5.74076 8.66536 6.10742V8.77409C8.66536 9.14076 8.36537 9.44076 7.9987 9.44076C7.63203 9.44076 7.33203 9.14076 7.33203 8.77409V6.10742C7.33203 5.74076 7.63203 5.44076 7.9987 5.44076ZM7.99203 2.10742C4.31203 2.10742 1.33203 5.09409 1.33203 8.77409C1.33203 12.4541 4.31203 15.4408 7.99203 15.4408C11.6787 15.4408 14.6654 12.4541 14.6654 8.77409C14.6654 5.09409 11.6787 2.10742 7.99203 2.10742ZM7.9987 14.1074C5.05203 14.1074 2.66536 11.7208 2.66536 8.77409C2.66536 5.82742 5.05203 3.44076 7.9987 3.44076C10.9454 3.44076 13.332 5.82742 13.332 8.77409C13.332 11.7208 10.9454 14.1074 7.9987 14.1074ZM8.66536 12.1074H7.33203V10.7741H8.66536V12.1074Z"
					fill="white"
				/>
			</svg>
			<span>The section is not yet completed</span>
		</div>
		<mat-expansion-panel
			(click)="recordToggleClicked($event, null, null, groupProfilePage)"
			data-cs-id="bba7ea45-83ad-4392-8894-ca93537e471f"
			data-cs-label="Most talked about brands"
			data-cs-source="page"
		>
			<mat-expansion-panel-header [expandedHeight]="renderedOn === 'Mobile' ? '130px' : '68px'" collapsedHeight="60px">
				<div class="panel-info">
					<div class="panel-title">
						<ng-container *ngIf="renderedOn === 'Mobile'">
							<div class="panel-title-header">
								<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
									<path
										d="M14.9997 5.00002H13.333C13.333 3.15835 11.8413 1.66669 9.99967 1.66669C8.15801 1.66669 6.66634 3.15835 6.66634 5.00002H4.99967C4.08301 5.00002 3.33301 5.75002 3.33301 6.66669V16.6667C3.33301 17.5834 4.08301 18.3334 4.99967 18.3334H14.9997C15.9163 18.3334 16.6663 17.5834 16.6663 16.6667V6.66669C16.6663 5.75002 15.9163 5.00002 14.9997 5.00002ZM9.99967 3.33335C10.9163 3.33335 11.6663 4.08335 11.6663 5.00002H8.33301C8.33301 4.08335 9.08301 3.33335 9.99967 3.33335ZM14.9997 16.6667H4.99967V6.66669H6.66634V8.33335C6.66634 8.79169 7.04134 9.16669 7.49967 9.16669C7.95801 9.16669 8.33301 8.79169 8.33301 8.33335V6.66669H11.6663V8.33335C11.6663 8.79169 12.0413 9.16669 12.4997 9.16669C12.958 9.16669 13.333 8.79169 13.333 8.33335V6.66669H14.9997V16.6667Z"
										fill="#9999A7"
									/>
								</svg>
								<span>Most talked about brands</span>
								<app-tooltip setTooltipText="Top brands that people are talking about in this group"></app-tooltip>
							</div>
						</ng-container>
						<ng-container *ngIf="renderedOn === 'Desktop'">
							<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
								<path
									d="M14.9997 5.00002H13.333C13.333 3.15835 11.8413 1.66669 9.99967 1.66669C8.15801 1.66669 6.66634 3.15835 6.66634 5.00002H4.99967C4.08301 5.00002 3.33301 5.75002 3.33301 6.66669V16.6667C3.33301 17.5834 4.08301 18.3334 4.99967 18.3334H14.9997C15.9163 18.3334 16.6663 17.5834 16.6663 16.6667V6.66669C16.6663 5.75002 15.9163 5.00002 14.9997 5.00002ZM9.99967 3.33335C10.9163 3.33335 11.6663 4.08335 11.6663 5.00002H8.33301C8.33301 4.08335 9.08301 3.33335 9.99967 3.33335ZM14.9997 16.6667H4.99967V6.66669H6.66634V8.33335C6.66634 8.79169 7.04134 9.16669 7.49967 9.16669C7.95801 9.16669 8.33301 8.79169 8.33301 8.33335V6.66669H11.6663V8.33335C11.6663 8.79169 12.0413 9.16669 12.4997 9.16669C12.958 9.16669 13.333 8.79169 13.333 8.33335V6.66669H14.9997V16.6667Z"
									fill="#9999A7"
								/>
							</svg>
							<span>Most talked about brands</span>
							<app-tooltip setTooltipText="Top brands that people are talking about in this group"></app-tooltip>
						</ng-container>
						<button
							*ngIf="isExpanded"
							data-cs-id="7c6c3647-c8dd-41c1-9be9-9309b38bb299"
							data-cs-label="What's this?"
							data-cs-source="page"
							class="convo-btn-bordered what-this-btn"
							(click)="
								$event.stopPropagation();
								recordButtonClick($event, null, null, null, groupProfilePage);
								openBrandsHelpVideo()
							"
						>
							<svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
								<path
									d="M6.1987 9.87409L9.31203 7.54076C9.49203 7.40742 9.49203 7.14076 9.31203 7.00742L6.1987 4.67409C5.9787 4.50742 5.66536 4.66742 5.66536 4.94076V9.60742C5.66536 9.88076 5.9787 10.0408 6.1987 9.87409ZM6.9987 0.607422C3.3187 0.607422 0.332031 3.59409 0.332031 7.27409C0.332031 10.9541 3.3187 13.9408 6.9987 13.9408C10.6787 13.9408 13.6654 10.9541 13.6654 7.27409C13.6654 3.59409 10.6787 0.607422 6.9987 0.607422ZM6.9987 12.6074C4.0587 12.6074 1.66536 10.2141 1.66536 7.27409C1.66536 4.33409 4.0587 1.94076 6.9987 1.94076C9.9387 1.94076 12.332 4.33409 12.332 7.27409C12.332 10.2141 9.9387 12.6074 6.9987 12.6074Z"
									fill="#3654FF"
								/>
							</svg>
							What's this?
						</button>
					</div>
					<div class="panel-description" *ngIf="isExpanded">
						<span
							>Convosight automatically identifies and displays brand names mentioned in conversations in your
							group.</span
						>
					</div>
				</div>
				<div class="panel-edit-btn">
					<div *ngIf="isExpanded" class="header-right">
						<button
							class="edit-row-btn"
							(click)="
								$event.stopPropagation();
								openEditBrandsModal = true;
								disableScrolling();
								recordButtonClick($event, null, null, null, groupProfilePage)
							"
							data-cs-id="bea6f8d5-7a85-4bc1-8db1-53b7516994df"
							data-cs-label="Edit Brand Modal"
							data-cs-source="page"
						>
							<img alt="" src="./assets/images/btn-icon-edit.svg" />
						</button>
					</div>
				</div>
			</mat-expansion-panel-header>

			<div class="profile-card-body">
				<div
					*ngIf="groupProfilePage?.mostTalkedAboutBrands?.length > 0; else unavailable"
					[class.disabled]="!groupProfilePage.showMostTalkedAboutBrands"
					class="brand-body-wrap"
				>
					<ul class="list-unstyled">
						<ng-container *ngFor="let brand of groupProfilePage.mostTalkedAboutBrands">
							<li *ngIf="isEditable ? true : brand.isSelected">
								<div [ngClass]="{' disabled': !brand.isSelected}" class="brand-box">
									<figure>
										<img
											[appDefaultImageSrc]="'./assets/images/brand-logo/default-brand-logo.png'"
											[src]="brand.brandImageURL"
											alt=""
										/>
										<p class="brand-name">
											{{ trimBrandName(brand.brandName) }}
											<span class="tooltip-text-wrapper">{{ brand.brandName }}</span>
										</p>
									</figure>
									<div [hidden]="brand.isSelected" class="hidden-state">
										<img alt="" src="./assets/images/visibility_off.svg" />
										<span>Hidden</span>
									</div>
								</div>
							</li>
						</ng-container>
					</ul>
					<div [hidden]="groupProfilePage.showMostTalkedAboutBrands" class="hidden-state">
						<img alt="" src="./assets/images/visibility_off.svg" />
						<span>This section is hidden</span>
					</div>
				</div>
			</div>
		</mat-expansion-panel>
	</div>
</mat-accordion>

<ng-template #publicPage>
	<div class="brands-wrap">
		<div class="profile-card-header">
			<div class="header-left">
				<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
					<path
						d="M14.9997 5.00002H13.333C13.333 3.15835 11.8413 1.66669 9.99967 1.66669C8.15801 1.66669 6.66634 3.15835 6.66634 5.00002H4.99967C4.08301 5.00002 3.33301 5.75002 3.33301 6.66669V16.6667C3.33301 17.5834 4.08301 18.3334 4.99967 18.3334H14.9997C15.9163 18.3334 16.6663 17.5834 16.6663 16.6667V6.66669C16.6663 5.75002 15.9163 5.00002 14.9997 5.00002ZM9.99967 3.33335C10.9163 3.33335 11.6663 4.08335 11.6663 5.00002H8.33301C8.33301 4.08335 9.08301 3.33335 9.99967 3.33335ZM14.9997 16.6667H4.99967V6.66669H6.66634V8.33335C6.66634 8.79169 7.04134 9.16669 7.49967 9.16669C7.95801 9.16669 8.33301 8.79169 8.33301 8.33335V6.66669H11.6663V8.33335C11.6663 8.79169 12.0413 9.16669 12.4997 9.16669C12.958 9.16669 13.333 8.79169 13.333 8.33335V6.66669H14.9997V16.6667Z"
						fill="#9999A7"
					/>
				</svg>
				<h5>
					<span>Most talked about brands</span>
					<app-tooltip setTooltipText="Top brands that people are talking about in this group"></app-tooltip>
				</h5>
			</div>
		</div>
		<div class="profile-card-body preview">
			<div *ngIf="groupProfilePage?.mostTalkedAboutBrands?.length > 0" class="brand-body-wrap">
				<ul class="list-unstyled">
					<ng-container *ngFor="let brand of groupProfilePage.mostTalkedAboutBrands">
						<li *ngIf="brand.isSelected">
							<div [ngClass]="{' disabled': !brand.isSelected}" class="brand-box">
								<figure>
									<img
										[appDefaultImageSrc]="'./assets/images/brand-logo/default-brand-logo.png'"
										[src]="brand.brandImageURL"
										alt=""
									/>
									<span>{{ brand.brandName }}</span>
								</figure>
							</div>
						</li>
					</ng-container>
				</ul>
			</div>
		</div>
	</div>
</ng-template>

<!-- Start : Edit brands Overlay -->

<!-- End :Edit brands Overlay -->
<ng-template #unavailable>
	<div class="unavailable-state-wrap">
		<img alt="" class="overlay-image" src="./assets/images/brands-dummy.png" />
		<div class="unavailable-state">
			<div class="overlay"></div>
			<figure>
				<svg fill="none" height="20" viewBox="0 0 20 20" width="20" xmlns="http://www.w3.org/2000/svg">
					<path
						d="M10.0003 1.66666C5.40033 1.66666 1.66699 5.39999 1.66699 9.99999C1.66699 14.6 5.40033 18.3333 10.0003 18.3333C14.6003 18.3333 18.3337 14.6 18.3337 9.99999C18.3337 5.39999 14.6003 1.66666 10.0003 1.66666ZM10.8337 14.1667H9.16699V12.5H10.8337V14.1667ZM10.8337 10.8333H9.16699V5.83332H10.8337V10.8333Z"
						fill="#EB5757"
					/>
				</svg>
			</figure>
			<h6>This section is hidden because no brands were found in the conversations in this group.</h6>
		</div>
	</div>
</ng-template>

<!-- What's this video start here -->
<ng-container *ngIf="showMostTalkBrandsVideo">
	<app-what-this-video
		[title]="'Most talked about brands'"
		[videoLink]="'./assets/videos/talk-about-brands.mp4'"
		(closeVideoPlayer)="closeVideoPlayer($event)"
	></app-what-this-video>
</ng-container>
<!-- What's this vide ends here -->

<ng-container *ngIf="openEditBrandsModal">
	<app-edit-brand-modal
		(closeModal)="reset()"
		(saveMostTalkedAboutBrandsSection)="saveMostTalkedAboutBrandsSection.emit()"
		[groupProfilePage]="groupProfilePage"
		[isSaveInProgress]="isSaveInProgress"
		[initialValue]="initialValue"
		[currentUserId]="currentUserId"
		[initialVisibilityValue]="initialVisibilityValue"
	></app-edit-brand-modal>
</ng-container>
