<mat-accordion *ngIf="isEditable; else publicPage">
	<div
		class="topics-wrap red-border"
		[class.expanded-state]="isExpanded"
		[class.not-completed]="noOfPopularTopics() === 0"
	>
		<div class="completed-flag" *ngIf="noOfPopularTopics() === 0">
			<svg width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg">
				<path
					d="M7.9987 5.44076C8.36537 5.44076 8.66536 5.74076 8.66536 6.10742V8.77409C8.66536 9.14076 8.36537 9.44076 7.9987 9.44076C7.63203 9.44076 7.33203 9.14076 7.33203 8.77409V6.10742C7.33203 5.74076 7.63203 5.44076 7.9987 5.44076ZM7.99203 2.10742C4.31203 2.10742 1.33203 5.09409 1.33203 8.77409C1.33203 12.4541 4.31203 15.4408 7.99203 15.4408C11.6787 15.4408 14.6654 12.4541 14.6654 8.77409C14.6654 5.09409 11.6787 2.10742 7.99203 2.10742ZM7.9987 14.1074C5.05203 14.1074 2.66536 11.7208 2.66536 8.77409C2.66536 5.82742 5.05203 3.44076 7.9987 3.44076C10.9454 3.44076 13.332 5.82742 13.332 8.77409C13.332 11.7208 10.9454 14.1074 7.9987 14.1074ZM8.66536 12.1074H7.33203V10.7741H8.66536V12.1074Z"
					fill="white"
				/>
			</svg>
			<span>The section is not yet completed</span>
		</div>
		<mat-expansion-panel
			(click)="recordToggleClicked($event, null, null, groupProfilePage)"
			data-cs-id="e51df20e-d76d-4683-8149-bd20100b1299"
			data-cs-label="Popular topics"
			data-cs-source="page"
		>
			<mat-expansion-panel-header [expandedHeight]="renderedOn === 'Mobile' ? '86px' : '68px'" collapsedHeight="60px">
				<div class="panel-info">
					<div class="panel-title">
						<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
							<path
								d="M12.5003 3.33335V9.16669H4.30866L3.81699 9.65835L3.33366 10.1417V3.33335H12.5003ZM13.3337 1.66669H2.50033C2.04199 1.66669 1.66699 2.04169 1.66699 2.50002V14.1667L5.00033 10.8334H13.3337C13.792 10.8334 14.167 10.4584 14.167 10V2.50002C14.167 2.04169 13.792 1.66669 13.3337 1.66669ZM17.5003 5.00002H15.8337V12.5H5.00033V14.1667C5.00033 14.625 5.37533 15 5.83366 15H15.0003L18.3337 18.3334V5.83335C18.3337 5.37502 17.9587 5.00002 17.5003 5.00002Z"
								fill="#9999A7"
							/>
						</svg>
						<span>Popular topics</span>
						<button
							*ngIf="isExpanded"
							data-cs-id="5a3050ec-19bf-4dc1-a1e8-d84caafacf01"
							data-cs-label="What's this?"
							data-cs-source="page"
							class="convo-btn-bordered what-this-btn"
							(click)="
								$event.stopPropagation();
								recordButtonClick($event, null, null, null, groupProfilePage);
								openTopicsHelpVideo()
							"
						>
							<svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
								<path
									d="M6.1987 9.87409L9.31203 7.54076C9.49203 7.40742 9.49203 7.14076 9.31203 7.00742L6.1987 4.67409C5.9787 4.50742 5.66536 4.66742 5.66536 4.94076V9.60742C5.66536 9.88076 5.9787 10.0408 6.1987 9.87409ZM6.9987 0.607422C3.3187 0.607422 0.332031 3.59409 0.332031 7.27409C0.332031 10.9541 3.3187 13.9408 6.9987 13.9408C10.6787 13.9408 13.6654 10.9541 13.6654 7.27409C13.6654 3.59409 10.6787 0.607422 6.9987 0.607422ZM6.9987 12.6074C4.0587 12.6074 1.66536 10.2141 1.66536 7.27409C1.66536 4.33409 4.0587 1.94076 6.9987 1.94076C9.9387 1.94076 12.332 4.33409 12.332 7.27409C12.332 10.2141 9.9387 12.6074 6.9987 12.6074Z"
									fill="#3654FF"
								/>
							</svg>
							What's this?
						</button>
					</div>
					<div class="panel-description" *ngIf="isExpanded">
						<span>This shows the most talked about topics in your group in the last 30 days.</span>
					</div>
				</div>
				<div class="panel-edit-btn">
					<div *ngIf="isExpanded" class="header-right section-icon-wrap">
						<button
							class="edit-row-btn"
							(click)="
								$event.stopPropagation();
								openTopicsModal = true;
								recordButtonClick($event, null, null, null, groupProfilePage)
							"
							data-cs-id="781bf7a1-a8f4-4eff-8fa2-dae70b100ed6"
							data-cs-label="Edit Topics Modal"
							data-cs-source="page"
						>
							<img alt="" src="./assets/images/btn-icon-edit.svg" />
						</button>
						<app-fixed-tooltip
							*ngIf="viewToolTip"
							[title]="welcomeTitle"
							[content]="welcomeContent"
						></app-fixed-tooltip>
					</div>
				</div>
			</mat-expansion-panel-header>

			<div class="profile-card-body">
				<div *ngIf="noOfPopularTopics() > 0; else unavailable" class="topic-body">
					<div [class.disabled]="!groupProfilePage.showPopularTopics">
						<ul class="list-unstyled">
							<ng-container *ngFor="let topic of groupProfilePage.popularTopics">
								<li *ngIf="topic.showTopic">{{ '#' + topic.keyword }}</li>
							</ng-container>
						</ul>
						<div *ngIf="!groupProfilePage.showPopularTopics" class="hidden-state">
							<img alt="" src="./assets/images/visibility_off.svg" />
							<span>This section is hidden</span>
						</div>
					</div>
				</div>
			</div>
		</mat-expansion-panel>
	</div>
</mat-accordion>

<ng-template #publicPage>
	<div class="topics-wrap">
		<div class="profile-card-header">
			<div class="header-left">
				<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
					<path
						d="M12.5003 3.33335V9.16669H4.30866L3.81699 9.65835L3.33366 10.1417V3.33335H12.5003ZM13.3337 1.66669H2.50033C2.04199 1.66669 1.66699 2.04169 1.66699 2.50002V14.1667L5.00033 10.8334H13.3337C13.792 10.8334 14.167 10.4584 14.167 10V2.50002C14.167 2.04169 13.792 1.66669 13.3337 1.66669ZM17.5003 5.00002H15.8337V12.5H5.00033V14.1667C5.00033 14.625 5.37533 15 5.83366 15H15.0003L18.3337 18.3334V5.83335C18.3337 5.37502 17.9587 5.00002 17.5003 5.00002Z"
						fill="#9999A7"
					/>
				</svg>
				<h5>
					<span>Popular topics</span>
					<app-tooltip
						setTooltipText="These are the topics that is being talked about the most in this group"
					></app-tooltip>
				</h5>
			</div>
		</div>
		<div class="profile-card-body preview">
			<div class="topic-body">
				<div>
					<ul class="list-unstyled">
						<ng-container *ngFor="let topic of groupProfilePage.popularTopics">
							<li *ngIf="topic.showTopic">{{ '#' + topic.keyword }}</li>
						</ng-container>
					</ul>
				</div>
			</div>
		</div>
	</div>
</ng-template>
<!-- Start : Edit topics Overlay -->
<div class="modal file-alert editTopicsModal" *ngIf="openTopicsModal">
	<div class="modal-dialog modal-dialog-centered">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title">Edit Popular topics</h5>
				<button
					#closeButtonForEditTopics
					(click)="reset(); recordButtonClick($event, null, null, null, groupProfilePage)"
					[disabled]="isSaveInProgress"
					data-cs-id="796f2830-8435-4e63-b4f8-0839e095ec7f"
					data-cs-label="Close"
					data-cs-source="page"
					type="button"
				>
					<span *ngIf="isSaveInProgress" class="btn-spinner"></span>
					<img *ngIf="!isSaveInProgress" alt="" src="./assets/images/close-icon.svg" />
				</button>
			</div>
			<div class="modal-body">
				<div class="topics-settings-card">
					<div *ngIf="noOfPopularTopics() < 1" class="topics-row-0">
						<p class="settings-field m-0">
							<img alt="" class="info-icon" src="assets/images/influencer-info-icon.svg" />
							You can show popular topics only if you enter at least topic.
						</p>
					</div>
					<div class="topics-row">
						<p class="settings-field m-0">Show Popular topics</p>
						<div class="slide-toggle-wrapper">
							<mat-slide-toggle
								(toggleChange)="recordToggleClicked($event); updateTopics()"
								[attr.data-cs-toggle-status]="!groupProfilePage.showPopularTopics && noOfPopularTopics() > 0"
								[(ngModel)]="groupProfilePage.showPopularTopics"
								[disabled]="noOfPopularTopics() === 0"
								data-cs-id="dabbf0ed-1211-34e1-8018-38cc99771b70"
								data-cs-label="show group admins"
								data-cs-source="page"
							></mat-slide-toggle>
						</div>
					</div>
				</div>
				<div class="popular-topics-wrap">
					<p class="title">Popular topics</p>
					<div class="mat-chip-wrapper">
						<mat-form-field appearance="fill" class="custom-input w-100">
							<mat-chip-list #chipList aria-label="Fruit selection">
								<mat-chip
									(removed)="topic.showTopic = false; updateTopics()"
									*ngFor="let topic of groupProfilePage.popularTopics"
									[hidden]="!topic.showTopic"
									[removable]="isSaveInProgress ? false : true"
									[selectable]="false"
								>
									{{ '#' + topic.keyword }}
									<button *ngIf="'true'" matChipRemove>
										<mat-icon>cancel</mat-icon>
									</button>
								</mat-chip>
								<input
									#topicsInput
									[disabled]="noOfPopularTopics() > 4 || isSaveInProgress"
									(matChipInputTokenEnd)="addKeywords($event, groupProfilePage.popularTopics)"
									value=""
									[matChipInputFor]="chipList"
									[matChipInputSeparatorKeyCodes]="separatorKeysCodes"
									[matChipInputAddOnBlur]="false"
									placeholder="{{ noOfPopularTopics() < 5 ? 'Enter comma (,) separated topics' : '' }}"
								/>
								<mat-error *ngIf="noOfPopularTopics() > 4">You can only add upto 5 topics </mat-error>
							</mat-chip-list>
						</mat-form-field>
					</div>
				</div>
			</div>
			<div class="modal-footer border-0 pt-0">
				<button
					(click)="
						updateTopics(closeButtonForEditTopics); recordButtonClick($event, null, null, null, groupProfilePage)
					"
					[disabled]="isSaveInProgress || !isSaveEnabled() || noOfPopularTopics() > 5"
					class="convo-btn-primary convo-btn-normal"
					type="button"
					data-cs-id="b61f77a1-863f-4a79-b7f1-6bc3dd97e672"
					data-cs-label="Save changes"
					data-cs-source="page"
				>
					<span class="btn-spinner" *ngIf="isSaveInProgress"></span>
					{{ isSaveInProgress ? 'Saving draft' : 'Done' }}
				</button>
			</div>
		</div>
	</div>
</div>
<!-- End :Edit topics Overlay -->

<ng-template #unavailable>
	<div class="unavailable-state-wrap">
		<div class="unavailable-state">
			<div class="overlay"></div>
			<figure>
				<svg fill="none" height="20" viewBox="0 0 20 20" width="20" xmlns="http://www.w3.org/2000/svg">
					<path
						d="M10.0003 1.66666C5.40033 1.66666 1.66699 5.39999 1.66699 9.99999C1.66699 14.6 5.40033 18.3333 10.0003 18.3333C14.6003 18.3333 18.3337 14.6 18.3337 9.99999C18.3337 5.39999 14.6003 1.66666 10.0003 1.66666ZM10.8337 14.1667H9.16699V12.5H10.8337V14.1667ZM10.8337 10.8333H9.16699V5.83332H10.8337V10.8333Z"
						fill="#EB5757"
					/>
				</svg>
			</figure>
			<h6>This section is hidden because you haven’t entered any popular topics for this group.</h6>
		</div>
	</div>
</ng-template>

<!-- What's this video start here -->
<ng-container *ngIf="showTopicsVideo">
	<app-what-this-video
		[title]="'Popular topics'"
		[videoLink]="'./assets/videos/popular-topics.mp4'"
		(closeVideoPlayer)="closeVideoPlayer($event)"
	></app-what-this-video>
</ng-container>
<!-- What's this vide ends here -->
